allprojects {
    apply plugin: 'java'
    apply plugin: 'eclipse'
    apply plugin: 'java-library'

    project.ext {
        slf4jVersion             = '1.7.30'
        log4jVersion             = '2.14.1'

        jacksonVersion           = '2.12.3'
        springfoxVersion           = '3.0.0'

        springBootVersion        = '2.5.0'
        springFrameworkVersion   = '5.3.7'
        springSecurityVersion    = '5.3.3.RELEASE'
        springIntegrationVersion = '5.5.0'
        springDataVersion        = '2.5.1'
        springDataJpaVersion     = '2.5.1'
        springBatchVersion       = '4.3.3'

        hibernateVersion          = '5.4.18.Final'
        hibernateValidatorVersion = '5.4.3.Final'

        jettyVersion             = "9.4.30.v20200611"
    }

    eclipse {
    classpath {
        downloadSources = true
         }
        project {}
    }
    eclipse.classpath.defaultOutputDir = file( 'build/classes' )

    group 'com.devteam'
    version '1.0'
    sourceCompatibility = 11
    compileJava.options.encoding = 'UTF-8'

    configurations {
        compile {
            transitive = true
        }
    }

    repositories {
        mavenLocal()
        mavenCentral()
        maven { url "https://repo.spring.io/plugins-release" }
        maven { url "https://repo.spring.io/milestone" }
    }

    task sourcesJar(type: Jar, dependsOn: classes) {
        classifier = 'sources'
        from sourceSets.main.allSource
    }

    artifacts {
        archives sourcesJar
    }

    dependencies {

        /********************LOMBOK******************/
        implementation 'org.projectlombok:lombok:1.18.16'
        annotationProcessor 'org.projectlombok:lombok:1.18.16'

        /*********************UNIT TEST**************/
        api group: 'junit', name: 'junit', version: '4.12'
        testRuntimeOnly "org.junit.platform:junit-platform-commons:1.7.0"
        implementation group: 'org.junit.jupiter', name: 'junit-jupiter-engine', version: '5.7.2'

        // cache
        api group: 'com.github.ben-manes.caffeine', name: 'caffeine', version: '3.0.3'
        api group: 'javax.cache', name: 'cache-api', version: '1.1.1'
        api group: 'org.ehcache', name: 'ehcache', version: '3.9.4'
        api group: 'org.glassfish.jaxb', name: 'jaxb-runtime', version: '2.3.1'
        api group: 'com.sun.istack', name: 'istack-commons-runtime', version: '4.0.1'

        // hibernate runtime
        api group: "javax.el", name: "javax.el-api",                version: "2.2.4"
        api group: "org.glassfish.web", name: "javax.el",           version: "2.2.4"

        api group: "org.hibernate", name: "hibernate-core",           version: hibernateVersion
        api group: "org.hibernate", name: "hibernate-entitymanager",  version: hibernateVersion

        api group: "org.hibernate", name: "hibernate-validator",      version: hibernateValidatorVersion
        api group: "net.bytebuddy", name: "byte-buddy-dep",           version: '1.10.13'
        api group: "org.ow2.asm", name: "asm",           version: '7.3.1'

        api group: "org.hibernate.common", name: "hibernate-commons-annotations", version: "5.1.0.Final"

        api group: "org.hibernate.javax.persistence", name: "hibernate-jpa-2.1-api", version: '1.0.2.Final'
        api group: "javax.persistence", name: "javax.persistence-api", version: '2.2'

        api group: "org.jboss", name: "jandex", version: '1.1.0.Final'
        api group: "org.jboss.logging", name: "jboss-logging", version: '3.3.1.Final'
        api group: "org.jboss.spec.javax.transaction", name: "jboss-transaction-api_1.2_spec", version: '1.0.0.Final'

        api group: "org.javassist", name: "javassist", version: '3.18.1-GA'
        api group: "dom4j", name: "dom4j", version: '1.6.1'
        api group: "antlr", name: "antlr", version: '2.7.7'
        // Database
        api group: "com.h2database", name: "h2", version: '1.4.200'
        api group: "org.hsqldb", name: "hsqldb", version: '2.3.4'
        api group: 'org.postgresql', name: 'postgresql', version: '42.2.5'
        api group: 'com.microsoft.sqlserver', name: 'mssql-jdbc', version: '9.2.0.jre11'
        //Hikari
        api group: 'com.zaxxer', name: 'HikariCP', version: '3.4.5'
        
        /*********Spring framework runtime**********/
        api group: "org.springframework", name: "spring-core", version: springFrameworkVersion
        api group: "org.springframework", name: "spring-beans", version: springFrameworkVersion
        api group: "org.springframework", name: "spring-context", version: springFrameworkVersion
        api group: "org.springframework", name: "spring-context-support", version: springFrameworkVersion
        api group: "org.springframework", name: "spring-aop", version: springFrameworkVersion
        api group: "org.springframework", name: "spring-expression", version: springFrameworkVersion
        api group: "org.springframework", name: "spring-web", version: springFrameworkVersion

        api group: 'org.springframework.data', name: 'spring-data-commons', version: springDataVersion
        api group: 'org.springframework.data', name: 'spring-data-jpa',     version: springDataJpaVersion

        api group: 'org.springframework.integration', name: 'spring-integration-core', version: springIntegrationVersion

        api group: "javax.inject", name: "javax.inject", version: "1"
        api group: 'org.yaml', name: 'snakeyaml', version: '1.15'


        api "org.springframework.boot:spring-boot:${springBootVersion}"
        api "org.springframework.boot:spring-boot-loader:${springBootVersion}"
        api "org.springframework.boot:spring-boot-configuration-processor:${springBootVersion}"
        api "org.springframework.boot:spring-boot-autoconfigure:${springBootVersion}"
        api "org.springframework.boot:spring-boot-starter:${springBootVersion}"
        api "org.springframework.boot:spring-boot-starter-jdbc:${springBootVersion}"
        api "org.springframework.boot:spring-boot-starter-data-jpa:${springBootVersion}"
        api "org.springframework.boot:spring-boot-starter-jetty:${springBootVersion}"
        api "org.springframework.boot:spring-boot-starter-web:${springBootVersion}"
        api "org.springframework.boot:spring-boot-starter-batch:${springBootVersion}"
        api "org.springframework.boot:spring-boot-starter-log4j2:${springBootVersion}"
        api "org.springframework.boot:spring-boot-starter-cache:${springBootVersion}"
        api "org.springframework.boot:spring-boot-starter-aop:${springBootVersion}"

        api "org.springframework.batch:spring-batch-core:${springBatchVersion}"
        api "org.springframework.batch:spring-batch-infrastructure:${springBatchVersion}"

        api group: "org.springframework.security", name: "spring-security-core", version: springSecurityVersion
        api group: "org.springframework.security", name: "spring-security-config", version: springSecurityVersion
        api group: "org.springframework.security", name: "spring-security-web", version: springSecurityVersion
        api group: "org.springframework.security", name: "spring-security-crypto", version: springSecurityVersion
        api group: "org.springframework.security", name: "spring-security-rsa", version: "1.0.1.RELEASE"


        api group: "org.springframework", name: "spring-jdbc", version: springFrameworkVersion
        api group: "org.springframework", name: "spring-tx", version: springFrameworkVersion
        api group: "org.springframework", name: "spring-orm", version: springFrameworkVersion


        api group: "org.webjars", name: "stomp-websocket", version: '2.3.3'
        api group: "org.springframework", name: "spring-messaging", version: springFrameworkVersion
        api group: "org.springframework", name: "spring-websocket", version: springFrameworkVersion
        api group: "org.springframework.boot", name: "spring-boot-starter-websocket", version: springBootVersion
        api group: 'io.micrometer', name: 'micrometer-core', version: '1.7.0'
        
        /*****************Common runtime ****************/
        api group: 'org.slf4j', name: 'slf4j-api', version:  slf4jVersion
        api group: 'org.slf4j', name: 'jcl-over-slf4j', version: slf4jVersion


        api group: 'ch.qos.logback', name: 'logback-core', version: '1.2.3'
        api group: 'ch.qos.logback', name: 'logback-classic', version: '1.2.3'

        api group: 'com.fasterxml.jackson.core', name: 'jackson-core', version: jacksonVersion
        api group: 'com.fasterxml.jackson.core', name: 'jackson-databind', version: jacksonVersion
        api group: 'com.fasterxml.jackson.core', name: 'jackson-annotations', version: jacksonVersion
        api group: 'com.fasterxml.jackson.dataformat', name: 'jackson-dataformat-yaml', version: jacksonVersion
        api group: 'com.fasterxml.jackson.dataformat', name: 'jackson-dataformat-smile', version: jacksonVersion

        api group: 'com.fasterxml', name: 'classmate', version: "1.3.4"

        api group: 'commons-codec', name: 'commons-codec', version: '1.10'

        api group: 'javax.validation', name: 'validation-api', version: '1.1.0.Final'
        api group: 'javax.activation', name: 'javax.activation-api', version: '1.2.0'
        api group: 'javax.xml.bind', name: 'jaxb-api', version: '2.3.1'
        api group: 'javax.annotation', name: 'javax.annotation-api', version: '1.3.2'
        api group: 'javax.servlet', name: 'javax.servlet-api', version: '3.1.0'
        api group: 'javax.batch', name: 'javax.batch-api', version: '1.0.1'
        api group: 'javax.mail', name: 'mail', version: '1.4'
        api group: 'com.sun.activation', name: 'javax.activation', version: '1.2.0'
    }

    test {
        forkEvery = 1
        ignoreFailures = true
        testLogging.showStandardStreams = true

        filter {
            includeTestsMatching "*UnitTest"
        }

        testLogging {
            events "passed", "skipped", "failed"
        }
    }

    task itest(type: Test) {
        description = 'Runs integration tests.'


        testLogging {
            events "passed", "skipped", "failed"
        }

        useJUnitPlatform {
            includeTags('integration')
        }

    }


    task utest(type: Test) {
        ignoreFailures = true
        description = 'Runs Unit tests.'

        testLogging {
            events "passed", "skipped", "failed"
        }

        useJUnitPlatform {
            includeTags('unit')
        }

    }

    task tofix(type: Test) {
        description = 'Runs tofix tests.'

        testLogging.showStandardStreams = true

        testLogging {
            events "passed", "skipped", "failed"
        }

        useJUnitPlatform {
            includeTags('tofix')
        }

    }

    task testJar(type: Jar) {
        classifier = 'tests'
        from sourceSets.test.output
    }
    configurations {
        tests
        published.extendsFrom tests, archives
    }
    artifacts {
        tests testJar
    }

    sourceSets {
        main {
        }
    }
    test {
        useJUnitPlatform()

        filter {
            includeTestsMatching "*UnitTest"
        }
    }
}


